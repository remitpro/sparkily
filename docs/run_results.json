{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-06-13T08:02:41.405864Z", "invocation_id": "f087384e-53ed-41d9-828a-a0a73b69a99b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.206098Z", "completed_at": "2025-06-13T08:02:41.214711Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.214711Z", "completed_at": "2025-06-13T08:02:41.214711Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009613037109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.sparkily.stg_log_data", "compiled": true, "compiled_code": "-- models/staging/stg_log_data.sql\n\nWITH source AS (\n    SELECT\n        [artist],\n        [auth],\n        [firstName],\n        [gender],\n        [itemInSession],\n        [lastName],\n        [length],\n        [level],\n        [location],\n        [method],\n        [page],\n        [registration],\n        [sessionId],\n        [song],\n        [status],\n        [ts],\n        [userAgent],\n        [userId]\n    FROM \"Sparkily\".\"dev\".\"log_data\"\n)\n\nSELECT *\nFROM source", "relation_name": "\"Sparkily\".\"stg\".\"stg_log_data\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.216833Z", "completed_at": "2025-06-13T08:02:41.221475Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.222472Z", "completed_at": "2025-06-13T08:02:41.222472Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00671076774597168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.sparkily.stg_songs", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT\n        [num_songs],\n        [artist_id],\n        [artist_latitude],\n        [artist_longitude],\n        [artist_location],\n        [artist_name],\n        [song_id],\n        [title],\n        [duration],\n        [year]\n    FROM \"Sparkily\".\"dev\".\"song_data\"\n)\n\nSELECT *\nFROM source", "relation_name": "\"Sparkily\".\"stg\".\"stg_songs\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.226415Z", "completed_at": "2025-06-13T08:02:41.228015Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.229068Z", "completed_at": "2025-06-13T08:02:41.229068Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004594087600708008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.sparkily.log_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.231006Z", "completed_at": "2025-06-13T08:02:41.232941Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.234942Z", "completed_at": "2025-06-13T08:02:41.234942Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00491642951965332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.sparkily.song_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.236941Z", "completed_at": "2025-06-13T08:02:41.241464Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.242799Z", "completed_at": "2025-06-13T08:02:41.242799Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006860017776489258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.sparkily.dim_time", "compiled": true, "compiled_code": "-- models/marts/core/dim_time.sql\n\nWITH base AS (\n    SELECT *\n    FROM \"Sparkily\".\"stg\".\"stg_log_data\"\n    WHERE page = 'NextSong'\n),\n\nconverted AS (\n    SELECT\n        ts,\n       --convert datetime  string to datetime\n        CAST(ts AS DATETIME) AS start_time\n       \n    FROM base\n),\n\ndim_time AS (\n    SELECT\n        start_time,\n        DATEPART(HOUR, start_time) AS hour,\n        DATEPART(DAY, start_time) AS day,\n        DATEPART(WEEK, start_time) AS week,\n        DATEPART(MONTH, start_time) AS month,\n        DATEPART(YEAR, start_time) AS year,\n        DATEPART(WEEKDAY, start_time) AS weekday\n    FROM converted\n)\n\nSELECT DISTINCT * FROM dim_time", "relation_name": "\"Sparkily\".\"dw\".\"dim_time\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.243859Z", "completed_at": "2025-06-13T08:02:41.295405Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.295405Z", "completed_at": "2025-06-13T08:02:41.295405Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05154609680175781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.sparkily.dim_users", "compiled": true, "compiled_code": "-- models/marts/core/dim_users.sql\n\nSELECT DISTINCT\n    CAST(userId AS INT) AS user_id,\n    firstName AS first_name,\n    lastName AS last_name,\n    gender,\n    level\nFROM \"Sparkily\".\"stg\".\"stg_log_data\"\nWHERE userId IS NOT NULL AND userId != ''", "relation_name": "\"Sparkily\".\"dw\".\"dim_users\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.298933Z", "completed_at": "2025-06-13T08:02:41.302942Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.302942Z", "completed_at": "2025-06-13T08:02:41.302942Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00602412223815918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.sparkily.dim_artists", "compiled": true, "compiled_code": "-- models/marts/core/dim_artists.sql\n\nSELECT DISTINCT\n    artist_id,\n    artist_name,\n    artist_location,\n    artist_latitude,\n    artist_longitude\nFROM \"Sparkily\".\"stg\".\"stg_songs\"", "relation_name": "\"Sparkily\".\"dw\".\"dim_artists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.304950Z", "completed_at": "2025-06-13T08:02:41.309746Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.310675Z", "completed_at": "2025-06-13T08:02:41.310675Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005724906921386719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.sparkily.dim_songs", "compiled": true, "compiled_code": "SELECT\n    artist_id,\n    song_id,\n    title,\n    duration,\n    year\nFROM \"Sparkily\".\"stg\".\"stg_songs\"", "relation_name": "\"Sparkily\".\"dw\".\"dim_songs\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.312683Z", "completed_at": "2025-06-13T08:02:41.323920Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.324891Z", "completed_at": "2025-06-13T08:02:41.324891Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0131988525390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.sparkily.not_null_dim_users_user_id.e754bb5812", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"Sparkily\".\"dw\".\"dim_users\"\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.327122Z", "completed_at": "2025-06-13T08:02:41.334184Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.334184Z", "completed_at": "2025-06-13T08:02:41.334184Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009070158004760742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.sparkily.unique_dim_users_user_id.bcdc17b9f9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom \"Sparkily\".\"dw\".\"dim_users\"\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.336181Z", "completed_at": "2025-06-13T08:02:41.343793Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.343793Z", "completed_at": "2025-06-13T08:02:41.343793Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0076122283935546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.sparkily.not_null_dim_artists_artist_id.53f5a0d348", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect artist_id\nfrom \"Sparkily\".\"dw\".\"dim_artists\"\nwhere artist_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.345788Z", "completed_at": "2025-06-13T08:02:41.351411Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.352484Z", "completed_at": "2025-06-13T08:02:41.352484Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007695436477661133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.sparkily.unique_dim_artists_artist_id.73b124aa40", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    artist_id as unique_field,\n    count(*) as n_records\n\nfrom \"Sparkily\".\"dw\".\"dim_artists\"\nwhere artist_id is not null\ngroup by artist_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.354500Z", "completed_at": "2025-06-13T08:02:41.359110Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.359110Z", "completed_at": "2025-06-13T08:02:41.359110Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005566835403442383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.sparkily.fact_songplays", "compiled": true, "compiled_code": "-- models/marts/core/fact_songplays.sql\n\nWITH base AS (\n    SELECT *\n    FROM \"Sparkily\".\"stg\".\"stg_log_data\"\n    WHERE page = 'NextSong'\n),\n\nsong_match AS (\n    SELECT\n        b.ts AS start_time,\n        CAST(b.userId AS INT) AS user_id,\n        b.level,\n        s.song_id,\n        a.artist_id,\n        b.sessionId AS session_id,\n        b.location,\n        b.userAgent AS user_agent\n    FROM base b\n    LEFT JOIN \"Sparkily\".\"dw\".\"dim_songs\" s\n        ON b.song = s.title\n        AND ABS(b.length - s.duration) < 2  -- handles small float precision issues\n    LEFT JOIN \"Sparkily\".\"dw\".\"dim_artists\" a\n        ON b.artist = a.artist_name\n)\n\nSELECT\n    ROW_NUMBER() OVER (ORDER BY start_time) AS songplay_id,  -- acts like SERIAL\n    CAST(start_time AS DATETIME) AS start_time,\n    user_id,\n    level,\n    song_id,\n    artist_id,\n    session_id,\n    location,\n    user_agent\nFROM song_match\nWHERE user_id IS NOT NULL", "relation_name": "\"Sparkily\".\"dw\".\"fact_songplays\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.361167Z", "completed_at": "2025-06-13T08:02:41.367114Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.367114Z", "completed_at": "2025-06-13T08:02:41.368420Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008304595947265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.sparkily.not_null_dim_songs_song_id.583c5f68b6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect song_id\nfrom \"Sparkily\".\"dw\".\"dim_songs\"\nwhere song_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.369442Z", "completed_at": "2025-06-13T08:02:41.376007Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.376968Z", "completed_at": "2025-06-13T08:02:41.376968Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0075266361236572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.sparkily.unique_dim_songs_song_id.ff70f120eb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    song_id as unique_field,\n    count(*) as n_records\n\nfrom \"Sparkily\".\"dw\".\"dim_songs\"\nwhere song_id is not null\ngroup by song_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.378667Z", "completed_at": "2025-06-13T08:02:41.383665Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.383665Z", "completed_at": "2025-06-13T08:02:41.383665Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006102561950683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.sparkily.songplays_user_insights", "compiled": true, "compiled_code": "-- analyses/songplays_user_insights.sql\n\n/*\n    Analysis: Users Listening Behavior\n    Purpose: Help the analytics team understand which users are listening to which songs,\n             including artist and song metadata.\n*/\n\nSELECT \n    sp.user_agent,\n    u.first_name,\n    u.last_name,\n    s.title,\n    s.duration,\n    a.artist_name\nFROM \"Sparkily\".\"dw\".\"fact_songplays\" AS sp\nJOIN \"Sparkily\".\"dw\".\"dim_users\" AS u \n    ON sp.user_id = u.user_id\nJOIN \"Sparkily\".\"dw\".\"dim_songs\" AS s \n    ON sp.song_id = s.song_id\nJOIN \"Sparkily\".\"dw\".\"dim_artists\" AS a \n    ON sp.artist_id = a.artist_id", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.385658Z", "completed_at": "2025-06-13T08:02:41.392314Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.393414Z", "completed_at": "2025-06-13T08:02:41.393414Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008806943893432617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.sparkily.not_null_fact_songplays_songplay_id.be10a0d5f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect songplay_id\nfrom \"Sparkily\".\"dw\".\"fact_songplays\"\nwhere songplay_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-13T08:02:41.395276Z", "completed_at": "2025-06-13T08:02:41.401801Z"}, {"name": "execute", "started_at": "2025-06-13T08:02:41.402799Z", "completed_at": "2025-06-13T08:02:41.402799Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008520841598510742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.sparkily.unique_fact_songplays_songplay_id.0f8a870504", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    songplay_id as unique_field,\n    count(*) as n_records\n\nfrom \"Sparkily\".\"dw\".\"fact_songplays\"\nwhere songplay_id is not null\ngroup by songplay_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 0.3304312229156494, "args": {"use_colors": true, "quiet": false, "use_colors_file": true, "write_json": true, "populate_cache": true, "source_freshness_run_project_hooks": false, "log_format_file": "debug", "printer_width": 80, "log_format": "default", "macro_debugging": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_level": "info", "introspect": true, "version_check": true, "favor_state": false, "send_anonymous_usage_stats": true, "compile": true, "select": [], "vars": {}, "partial_parse": true, "require_resource_names_without_spaces": false, "log_path": "C:\\Users\\tabdu\\OneDrive\\Desktop\\remitproworkstation\\sparkily\\sparkily\\logs", "static": false, "strict_mode": false, "which": "generate", "print": true, "show_resource_report": false, "log_level_file": "debug", "indirect_selection": "eager", "empty_catalog": false, "enable_legacy_logger": false, "partial_parse_file_diff": true, "warn_error_options": {"include": [], "exclude": []}, "project_dir": "C:\\Users\\tabdu\\OneDrive\\Desktop\\remitproworkstation\\sparkily\\sparkily", "profiles_dir": "C:\\Users\\tabdu\\.dbt", "log_file_max_bytes": 10485760, "static_parser": true, "defer": false, "cache_selected_only": false, "exclude": [], "invocation_command": "dbt docs generate"}}